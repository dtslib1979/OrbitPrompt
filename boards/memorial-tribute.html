<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Memorial Tribute â€” Chalkboard</title>
  <link rel="manifest" href="../manifest.webmanifest">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Noto+Serif+KR:wght@300;400;500;600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Color System */
      --bg-void: #000000;
      --bg-dark: #0a0a0a;
      --bg-card: #111111;
      --bg-input: #1a1a1a;
      --bg-elevated: #222222;

      --text-primary: #f5f5f5;
      --text-secondary: rgba(255,255,255,0.7);
      --text-muted: rgba(255,255,255,0.5);
      --text-dim: rgba(255,255,255,0.3);

      --accent-gold: #d4af37;
      --accent-gold-dim: rgba(212,175,55,0.2);
      --accent-gold-glow: rgba(212,175,55,0.4);

      --border: rgba(255,255,255,0.08);
      --border-light: rgba(255,255,255,0.15);

      /* Typography */
      --font-display: 'Cormorant Garamond', Georgia, serif;
      --font-korean: 'Noto Serif KR', serif;
      --font-ui: 'Inter', -apple-system, sans-serif;

      /* Timing */
      --transition-slow: 1.5s ease;
      --transition-medium: 0.5s ease;
      --transition-fast: 0.2s ease;
      --ken-burns-duration: 12s;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      width: 100%; height: 100%;
      background: var(--bg-void);
      font-family: var(--font-ui);
      color: var(--text-primary);
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      overflow-x: hidden;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SETUP MODE â€” Configuration Interface
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

    .setup {
      min-height: 100vh;
      padding: 1rem;
      padding-bottom: 6rem;
      overflow-y: auto;
      background: var(--bg-dark);
    }
    .setup.hidden { display: none; }

    /* Header */
    .setup-header {
      text-align: center;
      padding: 2rem 0;
      border-bottom: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }
    .setup-logo {
      font-family: var(--font-display);
      font-size: 1.75rem;
      font-weight: 300;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent-gold);
      margin-bottom: 0.25rem;
    }
    .setup-subtitle {
      font-size: 0.6875rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--text-dim);
    }

    /* Guide Section */
    .guide-section {
      background: linear-gradient(135deg, rgba(212,175,55,0.1) 0%, rgba(212,175,55,0.02) 100%);
      border: 1px solid var(--accent-gold);
      padding: 1.25rem;
      margin-bottom: 1.5rem;
    }
    .guide-title {
      font-family: var(--font-display);
      font-size: 0.875rem;
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--accent-gold);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .guide-title::before {
      content: 'ğŸ“–';
      font-size: 1rem;
    }
    .guide-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    .guide-item {
      background: rgba(0,0,0,0.3);
      padding: 0.75rem;
      border-left: 2px solid var(--accent-gold-dim);
    }
    .guide-item-title {
      font-size: 0.6875rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--accent-gold);
      margin-bottom: 0.375rem;
    }
    .guide-item-text {
      font-size: 0.75rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    .guide-item code {
      background: rgba(255,255,255,0.1);
      padding: 0.1rem 0.3rem;
      font-size: 0.625rem;
      font-family: monospace;
    }

    /* Workflow Steps */
    .workflow {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
      overflow-x: auto;
      padding-bottom: 0.5rem;
    }
    .workflow-step {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: var(--bg-card);
      padding: 0.5rem 0.75rem;
      font-size: 0.625rem;
      letter-spacing: 0.05em;
      color: var(--text-muted);
    }
    .workflow-step-num {
      width: 18px;
      height: 18px;
      background: var(--accent-gold-dim);
      color: var(--accent-gold);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.5625rem;
    }
    .workflow-arrow {
      color: var(--text-dim);
    }

    /* Form Sections */
    .form-section {
      background: var(--bg-card);
      border: 1px solid var(--border);
      margin-bottom: 1rem;
    }
    .form-section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.875rem 1rem;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
    }
    .form-section-title {
      font-size: 0.6875rem;
      font-weight: 600;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent-gold);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .form-section-title::before {
      content: '';
      width: 8px;
      height: 8px;
      background: var(--accent-gold);
    }
    .form-section-toggle {
      font-size: 0.625rem;
      color: var(--text-dim);
      transition: transform var(--transition-fast);
    }
    .form-section.open .form-section-toggle { transform: rotate(180deg); }
    .form-section-body {
      padding: 1rem;
      display: none;
    }
    .form-section.open .form-section-body { display: block; }

    /* Form Elements */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }
    @media (max-width: 480px) {
      .form-row { grid-template-columns: 1fr; }
    }
    .form-row.full { grid-template-columns: 1fr; }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.375rem;
    }
    .form-label {
      font-size: 0.5625rem;
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--text-muted);
    }
    .form-input, .form-textarea, .form-select {
      background: var(--bg-input);
      border: 1px solid var(--border);
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.875rem;
      padding: 0.75rem;
      transition: all var(--transition-fast);
    }
    .form-input:focus, .form-textarea:focus, .form-select:focus {
      outline: none;
      border-color: var(--accent-gold);
      box-shadow: 0 0 0 2px var(--accent-gold-dim);
    }
    .form-textarea {
      resize: vertical;
      min-height: 80px;
      line-height: 1.6;
    }
    .form-select {
      cursor: pointer;
    }
    .form-hint {
      font-size: 0.5625rem;
      color: var(--text-dim);
      margin-top: 0.25rem;
    }

    /* Section Cards */
    .section-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      margin-bottom: 0.75rem;
      transition: border-color var(--transition-fast);
    }
    .section-card:hover { border-color: var(--border-light); }
    .section-card-header {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      gap: 0.75rem;
    }
    .section-card-num {
      width: 28px;
      height: 28px;
      background: var(--accent-gold-dim);
      color: var(--accent-gold);
      font-family: var(--font-display);
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .section-card-info { flex: 1; }
    .section-card-title {
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 0.125rem;
    }
    .section-card-meta {
      font-size: 0.625rem;
      color: var(--text-dim);
      display: flex;
      gap: 0.75rem;
    }
    .section-card-toggle {
      font-size: 0.75rem;
      color: var(--text-dim);
      transition: transform var(--transition-fast);
    }
    .section-card.open .section-card-toggle { transform: rotate(180deg); }
    .section-card-body {
      padding: 1rem;
      display: none;
    }
    .section-card.open .section-card-body { display: block; }

    /* Image Preview */
    .image-preview-container {
      margin-top: 0.75rem;
    }
    .image-preview {
      width: 100%;
      height: 160px;
      background: var(--bg-input);
      border: 1px dashed var(--border-light);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }
    .image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .image-preview-placeholder {
      text-align: center;
      color: var(--text-dim);
    }
    .image-preview-placeholder-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      opacity: 0.5;
    }
    .image-preview-placeholder-text {
      font-size: 0.625rem;
      letter-spacing: 0.05em;
    }
    .image-preview-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(transparent, rgba(0,0,0,0.8));
      padding: 0.5rem;
      font-size: 0.5625rem;
      color: var(--text-muted);
    }

    /* Effect Preview Tags */
    .effect-tags {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
      flex-wrap: wrap;
    }
    .effect-tag {
      font-size: 0.5rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding: 0.25rem 0.5rem;
      background: var(--bg-elevated);
      color: var(--text-muted);
      border: 1px solid var(--border);
    }
    .effect-tag.active {
      background: var(--accent-gold-dim);
      color: var(--accent-gold);
      border-color: var(--accent-gold);
    }

    /* Buttons */
    .btn-group {
      display: flex;
      gap: 0.75rem;
      margin-top: 1.5rem;
    }
    .btn-group.sticky {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 1rem;
      background: linear-gradient(transparent, var(--bg-dark) 30%);
      margin: 0;
    }
    .btn {
      flex: 1;
      padding: 1rem;
      border: none;
      font-family: inherit;
      font-size: 0.75rem;
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all var(--transition-fast);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    .btn-primary {
      background: var(--accent-gold);
      color: #000;
    }
    .btn-primary:hover { filter: brightness(1.1); }
    .btn-primary:active { transform: scale(0.98); }
    .btn-secondary {
      background: transparent;
      border: 1px solid var(--border-light);
      color: var(--text-secondary);
    }
    .btn-secondary:hover {
      border-color: var(--accent-gold);
      color: var(--accent-gold);
    }
    .btn-icon { font-size: 1rem; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BROADCAST MODE â€” Presentation View
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

    .broadcast {
      position: fixed;
      inset: 0;
      display: none;
      background: var(--bg-void);
    }
    .broadcast.active { display: block; }

    /* Sections */
    .slide {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-slow);
    }
    .slide.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* Background Layer */
    .slide-bg {
      position: absolute;
      inset: -15%;
      width: 130%;
      height: 130%;
      background-size: cover;
      background-position: center;
      z-index: -2;
    }

    /* Ken Burns Animations */
    @keyframes kb-zoom-in {
      from { transform: scale(1) translate(0, 0); }
      to { transform: scale(1.2) translate(-2%, -2%); }
    }
    @keyframes kb-zoom-out {
      from { transform: scale(1.2) translate(-2%, -2%); }
      to { transform: scale(1) translate(0, 0); }
    }
    @keyframes kb-pan-left {
      from { transform: scale(1.15) translateX(5%); }
      to { transform: scale(1.15) translateX(-5%); }
    }
    @keyframes kb-pan-right {
      from { transform: scale(1.15) translateX(-5%); }
      to { transform: scale(1.15) translateX(5%); }
    }
    @keyframes kb-pan-up {
      from { transform: scale(1.15) translateY(5%); }
      to { transform: scale(1.15) translateY(-5%); }
    }
    @keyframes kb-diagonal {
      from { transform: scale(1.1) translate(-3%, 3%); }
      to { transform: scale(1.2) translate(3%, -3%); }
    }

    .kb-zoom-in { animation: kb-zoom-in var(--ken-burns-duration) ease-out forwards; }
    .kb-zoom-out { animation: kb-zoom-out var(--ken-burns-duration) ease-out forwards; }
    .kb-pan-left { animation: kb-pan-left var(--ken-burns-duration) ease-out forwards; }
    .kb-pan-right { animation: kb-pan-right var(--ken-burns-duration) ease-out forwards; }
    .kb-pan-up { animation: kb-pan-up var(--ken-burns-duration) ease-out forwards; }
    .kb-diagonal { animation: kb-diagonal var(--ken-burns-duration) ease-out forwards; }

    /* Color Filters (Oscar In Memoriam Style) */
    .filter-bw { filter: grayscale(100%) contrast(1.15) brightness(0.95); }
    .filter-bw-high { filter: grayscale(100%) contrast(1.4) brightness(0.85); }
    .filter-sepia { filter: sepia(40%) contrast(1.1) saturate(0.9); }
    .filter-warm { filter: sepia(15%) saturate(1.3) brightness(1.05) contrast(1.05); }
    .filter-cool { filter: saturate(0.8) brightness(1.1) hue-rotate(-10deg); }
    .filter-vivid { filter: saturate(1.2) contrast(1.1) brightness(1.05); }
    .filter-fade { filter: brightness(1.15) contrast(0.9) saturate(0.85); }

    /* Overlay Layers */
    .slide-overlay {
      position: absolute;
      inset: 0;
      z-index: -1;
    }
    .overlay-gradient-dark {
      background: linear-gradient(
        180deg,
        rgba(0,0,0,0.75) 0%,
        rgba(0,0,0,0.2) 25%,
        rgba(0,0,0,0.2) 75%,
        rgba(0,0,0,0.85) 100%
      );
    }
    .overlay-vignette {
      background: radial-gradient(
        ellipse 80% 80% at center,
        transparent 30%,
        rgba(0,0,0,0.7) 100%
      );
    }
    .overlay-film-grain {
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.04;
      pointer-events: none;
    }

    /* Content Layer */
    .slide-content {
      position: relative;
      z-index: 1;
      text-align: center;
      max-width: 800px;
      width: 100%;
    }

    /* Typography */
    .slide-num {
      font-family: var(--font-ui);
      font-size: 0.5rem;
      font-weight: 500;
      letter-spacing: 0.4em;
      text-transform: uppercase;
      color: var(--accent-gold);
      margin-bottom: 1.5rem;
      opacity: 0.8;
    }
    .slide-title {
      font-family: var(--font-display);
      font-size: clamp(2rem, 6vw, 3.5rem);
      font-weight: 300;
      letter-spacing: 0.05em;
      line-height: 1.2;
      margin-bottom: 0.5rem;
      text-shadow: 0 4px 30px rgba(0,0,0,0.8);
    }
    .slide-title-ko {
      font-family: var(--font-korean);
    }
    .slide-subtitle {
      font-family: var(--font-display);
      font-size: clamp(0.875rem, 2.5vw, 1.25rem);
      font-weight: 300;
      font-style: italic;
      color: var(--text-secondary);
      margin-bottom: 2.5rem;
      letter-spacing: 0.02em;
    }

    /* Quote Block */
    .slide-quote {
      font-family: var(--font-korean);
      font-size: clamp(1.125rem, 3.5vw, 1.75rem);
      font-weight: 300;
      line-height: 1.9;
      max-width: 650px;
      margin: 0 auto;
      padding: 2rem 2.5rem;
      text-align: left;
      position: relative;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(10px);
      border-left: 2px solid var(--accent-gold);
    }
    .slide-quote::before {
      content: '"';
      font-family: var(--font-display);
      font-size: 4rem;
      color: var(--accent-gold);
      opacity: 0.3;
      position: absolute;
      top: -0.5rem;
      left: 0.5rem;
      line-height: 1;
    }
    .slide-quote-source {
      margin-top: 1.25rem;
      font-size: 0.875rem;
      font-style: normal;
      color: var(--accent-gold);
      letter-spacing: 0.02em;
    }

    /* Final Slide (Tribute Card) */
    .slide-final {
      background: linear-gradient(180deg, #0a0a0a 0%, #000 100%);
    }
    .final-portrait {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 2px solid var(--accent-gold);
      margin-bottom: 1.5rem;
      overflow: hidden;
      box-shadow: 0 0 60px var(--accent-gold-dim);
    }
    .final-portrait img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .final-name {
      font-family: var(--font-korean);
      font-size: clamp(2rem, 7vw, 4rem);
      font-weight: 500;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
    }
    .final-title {
      font-family: var(--font-display);
      font-size: clamp(1rem, 3vw, 1.5rem);
      font-weight: 300;
      font-style: italic;
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
    }
    .final-years {
      font-family: var(--font-display);
      font-size: clamp(1.25rem, 4vw, 2rem);
      font-weight: 300;
      letter-spacing: 0.4em;
      color: var(--accent-gold);
      margin-bottom: 2rem;
    }
    .final-divider {
      width: 60px;
      height: 1px;
      background: var(--accent-gold);
      margin: 0 auto 2rem;
    }
    .final-message {
      font-family: var(--font-korean);
      font-size: 1rem;
      font-style: italic;
      color: var(--text-muted);
      line-height: 1.8;
    }

    /* Timeline Navigation */
    .timeline {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 0.75rem;
      z-index: 100;
    }
    .timeline-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.2);
      transition: all var(--transition-medium);
      cursor: pointer;
    }
    .timeline-dot:hover { background: rgba(255,255,255,0.3); }
    .timeline-dot.active {
      background: var(--accent-gold);
      border-color: var(--accent-gold);
      box-shadow: 0 0 15px var(--accent-gold-glow);
      transform: scale(1.2);
    }
    .timeline-dot.done {
      background: rgba(255,255,255,0.4);
      border-color: transparent;
    }

    /* Navigation Hint */
    .nav-hint {
      position: fixed;
      bottom: 4.5rem;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.5625rem;
      font-weight: 500;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.25);
      z-index: 100;
      transition: opacity var(--transition-medium);
    }

    /* Exit Button */
    .exit-btn {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.15);
      color: rgba(255,255,255,0.5);
      padding: 0.625rem 1rem;
      font-family: inherit;
      font-size: 0.5625rem;
      font-weight: 500;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      cursor: pointer;
      z-index: 100;
      transition: all var(--transition-fast);
    }
    .exit-btn:hover {
      border-color: var(--accent-gold);
      color: var(--accent-gold);
    }

    /* Touch Zones */
    .touch-zone {
      position: fixed;
      top: 0;
      height: 100%;
      z-index: 50;
    }
    .touch-zone-left { left: 0; width: 25%; }
    .touch-zone-right { right: 0; width: 75%; }

    /* Fade Transitions */
    .fade-overlay {
      position: fixed;
      inset: 0;
      z-index: 200;
      pointer-events: none;
      opacity: 0;
      transition: opacity 1s ease;
    }
    .fade-overlay.white { background: #fff; }
    .fade-overlay.black { background: #000; }
    .fade-overlay.active { opacity: 1; }

    /* Content Animations */
    @keyframes content-fade-up {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .slide.active .slide-content > * {
      animation: content-fade-up 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    .slide.active .slide-content > *:nth-child(1) { animation-delay: 0.2s; opacity: 0; }
    .slide.active .slide-content > *:nth-child(2) { animation-delay: 0.5s; opacity: 0; }
    .slide.active .slide-content > *:nth-child(3) { animation-delay: 0.8s; opacity: 0; }
    .slide.active .slide-content > *:nth-child(4) { animation-delay: 1.1s; opacity: 0; }
    .slide.active .slide-content > *:nth-child(5) { animation-delay: 1.4s; opacity: 0; }
  </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SETUP MODE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="setup" id="setupMode">

  <header class="setup-header">
    <h1 class="setup-logo">Memorial Tribute</h1>
    <p class="setup-subtitle">Ken Burns Documentary Style</p>
  </header>

  <!-- User Guide -->
  <section class="guide-section">
    <h2 class="guide-title">ì‚¬ìš© ê°€ì´ë“œ</h2>
    <div class="guide-grid">
      <div class="guide-item">
        <div class="guide-item-title">ì´ë¯¸ì§€ ì¤€ë¹„</div>
        <div class="guide-item-text">
          ìµœì†Œ <code>1920Ã—1080</code> í•´ìƒë„<br>
          Ken Burns ì¤Œ íš¨ê³¼ë¥¼ ìœ„í•´ ì—¬ë°± í•„ìš”
        </div>
      </div>
      <div class="guide-item">
        <div class="guide-item-title">ì´ë¯¸ì§€ ì†ŒìŠ¤</div>
        <div class="guide-item-text">
          Unsplash: <code>?w=1920</code> íŒŒë¼ë¯¸í„°<br>
          ë¡œì»¬: <code>../assets/images/íŒŒì¼.jpg</code>
        </div>
      </div>
      <div class="guide-item">
        <div class="guide-item-title">ì¸ìš©ë¬¸ ì‘ì„±</div>
        <div class="guide-item-text">
          ê³ ì¸ì˜ ì‹¤ì œ ë°œì–¸ ì‚¬ìš© ê¶Œì¥<br>
          2-3ë¬¸ì¥ì´ ê°€ì¥ íš¨ê³¼ì 
        </div>
      </div>
      <div class="guide-item">
        <div class="guide-item-title">íš¨ê³¼ ì„ íƒ</div>
        <div class="guide-item-text">
          ì´ˆë°˜: í‘ë°± (ê³¼ê±°/ì—„ìˆ™)<br>
          ì¤‘ë°˜: ì„¸í”¼ì•„â†’ì»¬ëŸ¬ (ì„±ì¥)<br>
          í›„ë°˜: ë”°ëœ»í•œ ìƒ‰ê° (ì¸ê°„ë¯¸)
        </div>
      </div>
    </div>
    <div class="workflow">
      <div class="workflow-step"><span class="workflow-step-num">1</span>ì •ë³´ ì…ë ¥</div>
      <span class="workflow-arrow">â†’</span>
      <div class="workflow-step"><span class="workflow-step-num">2</span>ì´ë¯¸ì§€ ì¶”ê°€</div>
      <span class="workflow-arrow">â†’</span>
      <div class="workflow-step"><span class="workflow-step-num">3</span>ì €ì¥</div>
      <span class="workflow-arrow">â†’</span>
      <div class="workflow-step"><span class="workflow-step-num">4</span>ë°©ì†¡ ì‹œì‘</div>
      <span class="workflow-arrow">â†’</span>
      <div class="workflow-step"><span class="workflow-step-num">5</span>í™”ë©´ ë…¹í™”</div>
    </div>
  </section>

  <!-- Subject Info -->
  <div class="form-section open">
    <div class="form-section-header" onclick="toggleSection(this)">
      <span class="form-section-title">ì¸ë¬¼ ì •ë³´</span>
      <span class="form-section-toggle">â–¼</span>
    </div>
    <div class="form-section-body">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">ì´ë¦„ (í•œê¸€)</label>
          <input type="text" class="form-input" id="subjectName" placeholder="í™ê¸¸ë™">
        </div>
        <div class="form-group">
          <label class="form-label">ì§í•¨ / ì†Œê°œ</label>
          <input type="text" class="form-input" id="subjectTitle" placeholder="ì „ êµ­ë¬´ì´ë¦¬">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">ìƒëª°ë…„</label>
          <input type="text" class="form-input" id="subjectYears" placeholder="1952 â€” 2025">
        </div>
        <div class="form-group">
          <label class="form-label">ë§ˆë¬´ë¦¬ ë©”ì‹œì§€</label>
          <input type="text" class="form-input" id="finalMessage" placeholder="ì˜ì›íˆ ê¸°ì–µí•˜ê² ìŠµë‹ˆë‹¤">
        </div>
      </div>
      <div class="form-row full">
        <div class="form-group">
          <label class="form-label">í”„ë¡œí•„ ì´ë¯¸ì§€ URL (ë§ˆì§€ë§‰ í™”ë©´ìš©)</label>
          <input type="text" class="form-input" id="portraitImage" placeholder="https://...">
          <span class="form-hint">ì •ì‚¬ê°í˜• ë¹„ìœ¨ ê¶Œì¥, ì›í˜•ìœ¼ë¡œ í‘œì‹œë¨</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Section Cards Container -->
  <div id="sectionCards"></div>

  <!-- Action Buttons (Sticky) -->
  <div class="btn-group sticky">
    <button class="btn btn-secondary" onclick="saveData()">
      <span class="btn-icon">ğŸ’¾</span> ì €ì¥
    </button>
    <button class="btn btn-secondary" onclick="loadSample()">
      <span class="btn-icon">ğŸ“‹</span> ìƒ˜í”Œ
    </button>
    <button class="btn btn-primary" onclick="startBroadcast()">
      <span class="btn-icon">â–¶</span> ë°©ì†¡ ì‹œì‘
    </button>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     BROADCAST MODE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="broadcast" id="broadcastMode">
  <div id="slidesContainer"></div>
  <div class="timeline" id="timeline"></div>
  <div class="nav-hint" id="navHint">TAP TO CONTINUE</div>
  <button class="exit-btn" onclick="exitBroadcast()">âœ• EXIT</button>
  <div class="touch-zone touch-zone-left" id="touchLeft"></div>
  <div class="touch-zone touch-zone-right" id="touchRight"></div>
  <div class="fade-overlay black" id="fadeBlack"></div>
</div>

<script>
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SECTION DEFINITIONS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const sectionDefs = [
    {
      num: '01',
      defaultTitle: 'ìš´ëª…ì˜ ì‹œì‘',
      defaultSubtitle: 'ì¸ìƒì˜ ì „í™˜ì ',
      filter: 'filter-bw',
      kenBurns: 'kb-zoom-in',
      description: 'ë„ì…ë¶€ â€” ì—„ìˆ™í•œ í‘ë°± í†¤'
    },
    {
      num: '02',
      defaultTitle: 'íˆ¬ì‚¬ì˜ ì‹œëŒ€',
      defaultSubtitle: 'ë„ì „ê³¼ ì„±ì¥',
      filter: 'filter-bw-high',
      kenBurns: 'kb-pan-left',
      description: 'ì „ê°œë¶€ â€” ê°•ë ¬í•œ ëŒ€ë¹„'
    },
    {
      num: '03',
      defaultTitle: 'ë¦¬ë”ì˜ ë¬´ê²Œ',
      defaultSubtitle: 'ì„±ì·¨ì™€ ì˜ê´‘',
      filter: 'filter-sepia',
      kenBurns: 'kb-diagonal',
      description: 'ì ˆì •ë¶€ â€” ì„¸í”¼ì•„ ì „í™˜'
    },
    {
      num: '04',
      defaultTitle: 'ì¸ê°„ì  ë©´ëª¨',
      defaultSubtitle: 'ì—¬ìœ ì™€ í•´í•™',
      filter: 'filter-warm',
      kenBurns: 'kb-pan-right',
      description: 'í™˜ê¸°ë¶€ â€” ë”°ëœ»í•œ ìƒ‰ê°'
    },
    {
      num: '05',
      defaultTitle: 'ì˜ì›í•œ ì•ˆì‹',
      defaultSubtitle: '',
      filter: 'filter-fade',
      kenBurns: 'kb-zoom-out',
      description: 'ê²°ë§ë¶€ â€” í˜ì´ë“œ ì•„ì›ƒ',
      isFinal: true
    }
  ];

  const filterOptions = [
    { value: 'filter-bw', label: 'í‘ë°±' },
    { value: 'filter-bw-high', label: 'í‘ë°± (ê³ ëŒ€ë¹„)' },
    { value: 'filter-sepia', label: 'ì„¸í”¼ì•„' },
    { value: 'filter-warm', label: 'ë”°ëœ»í•œ í†¤' },
    { value: 'filter-cool', label: 'ì°¨ê°€ìš´ í†¤' },
    { value: 'filter-vivid', label: 'ì„ ëª…í•œ ì»¬ëŸ¬' },
    { value: 'filter-fade', label: 'í˜ì´ë“œ' }
  ];

  const kenBurnsOptions = [
    { value: 'kb-zoom-in', label: 'ì¤Œ ì¸' },
    { value: 'kb-zoom-out', label: 'ì¤Œ ì•„ì›ƒ' },
    { value: 'kb-pan-left', label: 'íŒ¨ë‹ ì¢Œ' },
    { value: 'kb-pan-right', label: 'íŒ¨ë‹ ìš°' },
    { value: 'kb-pan-up', label: 'íŒ¨ë‹ ìƒ' },
    { value: 'kb-diagonal', label: 'ëŒ€ê°ì„ ' }
  ];

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SAMPLE DATA
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const sampleData = {
    subject: {
      name: 'ì´í•´ì°¬',
      title: 'ì „ êµ­ë¬´ì´ë¦¬ Â· ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹ ì „ ëŒ€í‘œ',
      years: '1952 â€” 2025'
    },
    portraitImage: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400',
    finalMessage: 'ë¯¼ì£¼ì£¼ì˜ë¥¼ ìœ„í•´ í—Œì‹ í•œ ì‚¶,\nì˜ì›íˆ ê¸°ì–µí•˜ê² ìŠµë‹ˆë‹¤.',
    sections: [
      {
        title: 'ìš´ëª…ì˜ ì‹œì‘',
        subtitle: '1972ë…„ 10ì›” 17ì¼, ìœ ì‹  ì„ í¬',
        quote: '10ì›” 17ì¼ì´ ì œ ì¸ìƒì„ ë°”ê¾¼ ë‚ ì…ë‹ˆë‹¤.\ní‰ë²”í•œ ëŒ€í•™ìƒì´ì—ˆë˜ ì œê°€ ë¯¼ì£¼í™” ìš´ë™ì— ë›°ì–´ë“¤ê²Œ ëœ ê³„ê¸°ì˜€ìŠµë‹ˆë‹¤.',
        quoteSource: 'â€” ì´í•´ì°¬, íšŒê³ ë¡ì—ì„œ',
        bgImage: 'https://images.unsplash.com/photo-1532375810709-75b1da00537c?w=1920',
        filter: 'filter-bw',
        kenBurns: 'kb-zoom-in'
      },
      {
        title: 'íˆ¬ì‚¬ì˜ ì‹œëŒ€',
        subtitle: '5ê³µ ì²­ë¬¸íšŒ, ê·¸ ì—­ì‚¬ì  ìˆœê°„',
        quote: 'ê±¸ë ˆëŠ” ë¹¨ì•„ë„ ê±¸ë ˆì…ë‹ˆë‹¤.',
        quoteSource: 'â€” 1988ë…„ 5ê³µ ì²­ë¬¸íšŒì—ì„œ',
        bgImage: 'https://images.unsplash.com/photo-1529107386315-e1a2ed48a620?w=1920',
        filter: 'filter-bw-high',
        kenBurns: 'kb-pan-left'
      },
      {
        title: 'ë¦¬ë”ì˜ ë¬´ê²Œ',
        subtitle: 'êµ­ë¬´ì´ë¦¬, ê·¸ë¦¬ê³  ë‹¹ëŒ€í‘œ',
        quote: 'ì´ê²ƒì´ ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹ì˜ ì—­ì‚¬ì…ë‹ˆë‹¤.\nìš°ë¦¬ëŠ” í•­ìƒ êµ­ë¯¼ê³¼ í•¨ê»˜ ê±¸ì–´ì™”ìŠµë‹ˆë‹¤.',
        quoteSource: 'â€” ë‹¹ëŒ€í‘œ ìˆ˜ë½ ì—°ì„¤ì—ì„œ',
        bgImage: 'https://images.unsplash.com/photo-1541872703-74c5e44368f9?w=1920',
        filter: 'filter-sepia',
        kenBurns: 'kb-diagonal'
      },
      {
        title: 'ì¸ê°„ ì´í•´ì°¬',
        subtitle: 'í›„ë°°ë“¤ì—ê²Œ ë‚¨ê¸´ ì—¬ìœ ',
        quote: 'ë…ì¬í•˜ê³  ì‹¸ìš°ë‹¤ê°€...\nì§€ê¸ˆ ì•¼ë‹¹ì€ ê°€ì§œ ê°™ì•„ì„œ ì‹¸ìš°ëŠ” ì¬ë¯¸ê°€ ì—†ë‹¤.',
        quoteSource: 'â€” í›„ë°° ì˜ì›ë“¤ê³¼ì˜ ëŒ€í™”ì—ì„œ',
        bgImage: 'https://images.unsplash.com/photo-1517486808906-6ca8b3f04846?w=1920',
        filter: 'filter-warm',
        kenBurns: 'kb-pan-right'
      },
      {
        title: 'ì˜ì›í•œ ì•ˆì‹',
        subtitle: '',
        quote: 'êµ­ë¯¼ë“¤ê»˜ ë§ì€ ì„±ì›ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.\nê²°ì½” ìŠì§€ ì•Šê² ìŠµë‹ˆë‹¤.',
        quoteSource: 'â€” ë§ˆì§€ë§‰ ì¸ì‚¬',
        bgImage: '',
        filter: 'filter-fade',
        kenBurns: 'kb-zoom-out'
      }
    ]
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // UI RENDERING
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  function renderSectionCards() {
    const container = document.getElementById('sectionCards');
    container.innerHTML = sectionDefs.map((s, i) => `
      <div class="section-card ${i === 0 ? 'open' : ''}" data-index="${i}">
        <div class="section-card-header" onclick="toggleCard(${i})">
          <span class="section-card-num">${s.num}</span>
          <div class="section-card-info">
            <div class="section-card-title">${s.defaultTitle}</div>
            <div class="section-card-meta">
              <span>${s.description}</span>
            </div>
          </div>
          <span class="section-card-toggle">â–¼</span>
        </div>
        <div class="section-card-body">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">ì„¹ì…˜ ì œëª©</label>
              <input type="text" class="form-input" id="sec${i}_title" placeholder="${s.defaultTitle}">
            </div>
            <div class="form-group">
              <label class="form-label">ë¶€ì œëª©</label>
              <input type="text" class="form-input" id="sec${i}_subtitle" placeholder="${s.defaultSubtitle}">
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">ì¸ìš©ë¬¸</label>
              <textarea class="form-textarea" id="sec${i}_quote" placeholder="ê³ ì¸ì˜ ëª…ì–¸ ë˜ëŠ” í•µì‹¬ ë©”ì‹œì§€"></textarea>
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">ì¸ìš© ì¶œì²˜</label>
              <input type="text" class="form-input" id="sec${i}_quoteSource" placeholder="â€” ì¶œì²˜, ì—°ë„">
            </div>
          </div>
          ${!s.isFinal ? `
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">ìƒ‰ê° í•„í„°</label>
              <select class="form-select" id="sec${i}_filter">
                ${filterOptions.map(f => `<option value="${f.value}" ${f.value === s.filter ? 'selected' : ''}>${f.label}</option>`).join('')}
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Ken Burns íš¨ê³¼</label>
              <select class="form-select" id="sec${i}_kenBurns">
                ${kenBurnsOptions.map(k => `<option value="${k.value}" ${k.value === s.kenBurns ? 'selected' : ''}>${k.label}</option>`).join('')}
              </select>
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">ë°°ê²½ ì´ë¯¸ì§€ URL</label>
              <input type="text" class="form-input" id="sec${i}_bgImage" placeholder="https://..." oninput="previewImage(${i})">
              <div class="image-preview-container">
                <div class="image-preview" id="sec${i}_preview">
                  <div class="image-preview-placeholder">
                    <div class="image-preview-placeholder-icon">ğŸ–¼ï¸</div>
                    <div class="image-preview-placeholder-text">ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          ` : ''}
        </div>
      </div>
    `).join('');
  }

  function toggleSection(el) {
    el.closest('.form-section').classList.toggle('open');
  }

  function toggleCard(index) {
    document.querySelector(`.section-card[data-index="${index}"]`).classList.toggle('open');
  }

  function previewImage(index) {
    const url = document.getElementById(`sec${index}_bgImage`).value;
    const preview = document.getElementById(`sec${index}_preview`);
    if (url) {
      preview.innerHTML = `<img src="${url}" onerror="this.parentElement.innerHTML='<div class=image-preview-placeholder><div class=image-preview-placeholder-icon>âš ï¸</div><div class=image-preview-placeholder-text>ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨</div></div>'">`;
    } else {
      preview.innerHTML = '<div class="image-preview-placeholder"><div class="image-preview-placeholder-icon">ğŸ–¼ï¸</div><div class="image-preview-placeholder-text">ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”</div></div>';
    }
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // DATA MANAGEMENT
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  function collectData() {
    return {
      subject: {
        name: document.getElementById('subjectName').value || 'ì´ë¦„',
        title: document.getElementById('subjectTitle').value || 'ì§í•¨',
        years: document.getElementById('subjectYears').value || '0000 â€” 0000'
      },
      portraitImage: document.getElementById('portraitImage').value || '',
      finalMessage: document.getElementById('finalMessage').value || 'ì˜ì›íˆ ê¸°ì–µí•˜ê² ìŠµë‹ˆë‹¤',
      sections: sectionDefs.map((s, i) => ({
        num: s.num,
        title: document.getElementById(`sec${i}_title`).value || s.defaultTitle,
        subtitle: document.getElementById(`sec${i}_subtitle`).value || s.defaultSubtitle,
        quote: document.getElementById(`sec${i}_quote`).value || '',
        quoteSource: document.getElementById(`sec${i}_quoteSource`).value || '',
        bgImage: document.getElementById(`sec${i}_bgImage`)?.value || '',
        filter: document.getElementById(`sec${i}_filter`)?.value || s.filter,
        kenBurns: document.getElementById(`sec${i}_kenBurns`)?.value || s.kenBurns,
        isFinal: s.isFinal || false
      }))
    };
  }

  function fillData(data) {
    document.getElementById('subjectName').value = data.subject.name || '';
    document.getElementById('subjectTitle').value = data.subject.title || '';
    document.getElementById('subjectYears').value = data.subject.years || '';
    document.getElementById('portraitImage').value = data.portraitImage || '';
    document.getElementById('finalMessage').value = data.finalMessage || '';

    data.sections.forEach((s, i) => {
      const titleEl = document.getElementById(`sec${i}_title`);
      const subtitleEl = document.getElementById(`sec${i}_subtitle`);
      const quoteEl = document.getElementById(`sec${i}_quote`);
      const sourceEl = document.getElementById(`sec${i}_quoteSource`);
      const bgEl = document.getElementById(`sec${i}_bgImage`);
      const filterEl = document.getElementById(`sec${i}_filter`);
      const kbEl = document.getElementById(`sec${i}_kenBurns`);

      if (titleEl) titleEl.value = s.title || '';
      if (subtitleEl) subtitleEl.value = s.subtitle || '';
      if (quoteEl) quoteEl.value = s.quote || '';
      if (sourceEl) sourceEl.value = s.quoteSource || '';
      if (bgEl) { bgEl.value = s.bgImage || ''; previewImage(i); }
      if (filterEl) filterEl.value = s.filter || sectionDefs[i].filter;
      if (kbEl) kbEl.value = s.kenBurns || sectionDefs[i].kenBurns;
    });
  }

  function saveData() {
    localStorage.setItem('memorial-tribute-data', JSON.stringify(collectData()));
    alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
  }

  function loadData() {
    const saved = localStorage.getItem('memorial-tribute-data');
    if (saved) fillData(JSON.parse(saved));
  }

  function loadSample() {
    fillData(sampleData);
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // BROADCAST MODE
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  let currentSlide = 0;
  let broadcastData = null;

  function startBroadcast() {
    broadcastData = collectData();

    const hasImages = broadcastData.sections.slice(0, -1).some(s => s.bgImage);
    if (!hasImages && !confirm('ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

    document.getElementById('setupMode').classList.add('hidden');
    document.getElementById('broadcastMode').classList.add('active');

    currentSlide = 0;
    renderSlides();

    setTimeout(() => {
      document.getElementById('navHint').style.opacity = '0';
    }, 4000);
  }

  function exitBroadcast() {
    document.getElementById('broadcastMode').classList.remove('active');
    document.getElementById('setupMode').classList.remove('hidden');
  }

  function renderSlides() {
    const container = document.getElementById('slidesContainer');
    const sections = broadcastData.sections;

    container.innerHTML = sections.map((s, i) => {
      if (s.isFinal) {
        return `
          <div class="slide slide-final ${i === 0 ? 'active' : ''}" data-index="${i}">
            <div class="slide-overlay overlay-vignette"></div>
            <div class="slide-overlay overlay-film-grain"></div>
            <div class="slide-content">
              <div class="slide-num">${s.num}</div>
              ${broadcastData.portraitImage ? `
                <div class="final-portrait">
                  <img src="${broadcastData.portraitImage}" alt="">
                </div>
              ` : ''}
              <div class="final-name">${broadcastData.subject.name}</div>
              <div class="final-title">${broadcastData.subject.title}</div>
              <div class="final-years">${broadcastData.subject.years}</div>
              <div class="final-divider"></div>
              <div class="slide-quote" style="border:none;text-align:center;background:transparent;max-width:500px;">
                ${(s.quote || '').replace(/\n/g, '<br>')}
                ${s.quoteSource ? `<div class="slide-quote-source">${s.quoteSource}</div>` : ''}
              </div>
              <div class="final-message">${broadcastData.finalMessage.replace(/\n/g, '<br>')}</div>
            </div>
          </div>
        `;
      }
      return `
        <div class="slide ${i === 0 ? 'active' : ''}" data-index="${i}">
          <div class="slide-bg ${s.filter} ${s.kenBurns}" style="background-image:url('${s.bgImage}')"></div>
          <div class="slide-overlay overlay-gradient-dark"></div>
          <div class="slide-overlay overlay-vignette"></div>
          <div class="slide-overlay overlay-film-grain"></div>
          <div class="slide-content">
            <div class="slide-num">${s.num}</div>
            <h2 class="slide-title slide-title-ko">${s.title}</h2>
            <p class="slide-subtitle">${s.subtitle}</p>
            <blockquote class="slide-quote">
              ${(s.quote || '').replace(/\n/g, '<br>')}
              ${s.quoteSource ? `<cite class="slide-quote-source">${s.quoteSource}</cite>` : ''}
            </blockquote>
          </div>
        </div>
      `;
    }).join('');

    renderTimeline();
  }

  function renderTimeline() {
    const timeline = document.getElementById('timeline');
    timeline.innerHTML = broadcastData.sections.map((_, i) => `
      <div class="timeline-dot ${i < currentSlide ? 'done' : ''} ${i === currentSlide ? 'active' : ''}" onclick="goTo(${i})"></div>
    `).join('');
  }

  function goTo(index) {
    if (index < 0 || index >= broadcastData.sections.length) return;

    document.querySelectorAll('.slide').forEach(el => el.classList.remove('active'));
    currentSlide = index;

    const slide = document.querySelector(`.slide[data-index="${index}"]`);
    if (slide) {
      slide.classList.add('active');
      const bg = slide.querySelector('.slide-bg');
      if (bg) {
        bg.style.animation = 'none';
        bg.offsetHeight;
        bg.style.animation = '';
      }
    }

    renderTimeline();
  }

  function next() { if (currentSlide < broadcastData.sections.length - 1) goTo(currentSlide + 1); }
  function prev() { if (currentSlide > 0) goTo(currentSlide - 1); }

  // Event Listeners
  document.getElementById('touchRight').addEventListener('click', next);
  document.getElementById('touchLeft').addEventListener('click', prev);

  document.addEventListener('keydown', (e) => {
    if (!document.getElementById('broadcastMode').classList.contains('active')) return;
    if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); next(); }
    if (e.key === 'ArrowLeft') { e.preventDefault(); prev(); }
    if (e.key === 'Escape') exitBroadcast();
  });

  let touchStartX = 0;
  document.addEventListener('touchstart', e => { touchStartX = e.touches[0].clientX; }, { passive: true });
  document.addEventListener('touchend', e => {
    if (!document.getElementById('broadcastMode').classList.contains('active')) return;
    const diff = touchStartX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 50) diff > 0 ? next() : prev();
  }, { passive: true });

  // Initialize
  renderSectionCards();
  loadData();
</script>
</body>
</html>
