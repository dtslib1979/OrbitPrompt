<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0a0a0a">
  <title>Route Generator â€” OrbitPrompt</title>
  <link rel="icon" href="../../assets/icon.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-void: #050505;
      --bg-primary: #0a0a0a;
      --bg-surface: #0f0f0f;
      --bg-card: #141414;
      --bg-input: #1a1a1a;
      --text-primary: #f0f0f0;
      --text-secondary: rgba(255,255,255,0.7);
      --text-muted: rgba(255,255,255,0.4);
      --accent: #22d3ee;
      --accent-dim: rgba(34,211,238,0.15);
      --purple: #a855f7;
      --purple-dim: rgba(168,85,247,0.15);
      --gold: #d4af37;
      --gold-dim: rgba(212,175,55,0.15);
      --red: #ef4444;
      --red-dim: rgba(239,68,68,0.15);
      --green: #22c55e;
      --green-dim: rgba(34,197,94,0.15);
      --border: rgba(255,255,255,0.08);
      --font-sans: 'Inter', -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: var(--font-sans);
      background: var(--bg-void);
      color: var(--text-primary);
      min-height: 100vh;
      padding: 1.5rem;
      line-height: 1.6;
    }
    .container { max-width: 640px; margin: 0 auto; }

    header {
      text-align: center;
      padding: 1.5rem 0 2rem;
      border-bottom: 1px solid var(--border);
      margin-bottom: 2rem;
    }
    .tag {
      font-family: var(--font-mono);
      font-size: 0.5625rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent);
      background: var(--accent-dim);
      padding: 0.25rem 0.5rem;
      display: inline-block;
      margin-bottom: 0.75rem;
    }
    h1 { font-family: var(--font-mono); font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
    .subtitle { font-size: 0.8125rem; color: var(--text-muted); }

    .section {
      background: var(--bg-card);
      border: 1px solid var(--border);
      padding: 1.25rem;
      margin-bottom: 1rem;
    }
    .section-title {
      font-family: var(--font-mono);
      font-size: 0.6875rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 1rem;
    }

    label {
      display: block;
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-bottom: 0.375rem;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.625rem 0.75rem;
      background: var(--bg-input);
      border: 1px solid var(--border);
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.8125rem;
      margin-bottom: 1rem;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
    }
    textarea { resize: vertical; min-height: 80px; font-family: var(--font-mono); font-size: 0.75rem; }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    @media (max-width: 480px) { .grid-2 { grid-template-columns: 1fr; } }

    /* Route Selector */
    .route-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    @media (max-width: 480px) { .route-grid { grid-template-columns: repeat(2, 1fr); } }
    .route-chip {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
      padding: 0.75rem 0.5rem;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.15s;
    }
    .route-chip:hover { border-color: var(--accent); }
    .route-chip.active {
      border-color: var(--accent);
      background: var(--accent-dim);
    }
    .route-chip.active .route-label { color: var(--accent); }
    .route-greek {
      font-family: var(--font-mono);
      font-size: 1.25rem;
      font-weight: 600;
    }
    .route-label {
      font-family: var(--font-mono);
      font-size: 0.5rem;
      letter-spacing: 0.05em;
      color: var(--text-muted);
      text-align: center;
    }

    /* OP List */
    .op-list { display: flex; flex-direction: column; gap: 0.5rem; }
    .op-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem;
      background: var(--bg-input);
      border: 1px solid var(--border);
    }
    .op-num {
      font-family: var(--font-mono);
      font-size: 0.625rem;
      font-weight: 600;
      color: var(--accent);
      width: 2rem;
      text-align: center;
      flex-shrink: 0;
    }
    .op-input {
      flex: 1;
      background: transparent;
      border: none;
      border-bottom: 1px solid var(--border);
      padding: 0.25rem 0;
      color: var(--text-primary);
      font-size: 0.8125rem;
      margin-bottom: 0;
    }
    .op-input:focus { outline: none; border-color: var(--accent); }
    .op-remove {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 1rem;
      padding: 0.25rem;
    }
    .op-remove:hover { color: var(--red); }
    .add-op-btn {
      width: 100%;
      padding: 0.625rem;
      background: transparent;
      border: 1px dashed var(--border);
      color: var(--text-muted);
      font-size: 0.75rem;
      cursor: pointer;
      margin-top: 0.5rem;
    }
    .add-op-btn:hover { border-color: var(--accent); color: var(--accent); }

    /* Toggles */
    .toggles { display: flex; flex-direction: column; gap: 0.75rem; }
    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem;
      background: var(--bg-input);
      border: 1px solid var(--border);
    }
    .toggle-label { font-size: 0.8125rem; }
    .toggle-desc { font-size: 0.625rem; color: var(--text-muted); }
    .toggle-switch {
      width: 44px;
      height: 24px;
      background: var(--border);
      border-radius: 12px;
      position: relative;
      cursor: pointer;
      transition: background 0.2s;
    }
    .toggle-switch.active { background: var(--accent); }
    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: #fff;
      border-radius: 50%;
      transition: transform 0.2s;
    }
    .toggle-switch.active::after { transform: translateX(20px); }

    /* Buttons */
    .btn {
      padding: 0.75rem 1.25rem;
      border: none;
      font-family: inherit;
      font-size: 0.75rem;
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.15s;
    }
    .btn-primary {
      background: var(--accent);
      color: #000;
      width: 100%;
    }
    .btn-primary:hover { filter: brightness(1.1); }
    .btn-secondary {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text-secondary);
    }
    .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }

    /* Output */
    .output-section {
      background: var(--bg-card);
      border: 2px solid var(--accent);
      display: none;
      margin-top: 1.5rem;
    }
    .output-header {
      background: var(--accent-dim);
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--accent);
    }
    .output-title {
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--accent);
    }
    .output-body { padding: 1.25rem; }
    .output-prompt {
      background: var(--bg-input);
      border: 1px solid var(--border);
      padding: 1rem;
      font-family: var(--font-mono);
      font-size: 0.75rem;
      line-height: 1.7;
      color: var(--text-secondary);
      white-space: pre-wrap;
      max-height: 400px;
      overflow-y: auto;
    }
    .philosophy-note {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      margin-top: 1rem;
      padding: 1rem;
      background: var(--accent-dim);
      border-left: 3px solid var(--accent);
    }
    .philosophy-icon { font-size: 1.25rem; }
    .philosophy-note p { font-size: 0.8125rem; line-height: 1.6; color: var(--text-secondary); }
    .philosophy-note strong { color: var(--accent); }
    .btn-row { display: flex; gap: 0.75rem; margin-top: 1.5rem; }
    .btn-full { flex: 1; }

    footer {
      text-align: center;
      padding: 2rem 0 1rem;
      border-top: 1px solid var(--border);
      margin-top: 2rem;
    }
    .footer-link {
      font-family: var(--font-mono);
      font-size: 0.625rem;
      color: var(--text-muted);
      text-decoration: none;
    }
    .footer-link:hover { color: var(--accent); }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <span class="tag">Prompt Engine</span>
      <h1>Route Generator</h1>
      <p class="subtitle">FAB ë¼ìš°íŠ¸ ì •ì˜ â†’ ë³¸ì‚¬ ëŒ€ì‹œë³´ë“œ ì—°ë™</p>
    </header>

    <!-- Route ID -->
    <div class="section">
      <p class="section-title">ë¼ìš°íŠ¸ ì„ íƒ</p>
      <div class="route-grid" id="routeGrid">
        <div class="route-chip active" data-route="RT-Î±">
          <span class="route-greek">Î±</span>
          <span class="route-label">ì½˜í…ì¸  ìƒì‚°</span>
        </div>
        <div class="route-chip" data-route="RT-Î²">
          <span class="route-greek">Î²</span>
          <span class="route-label">ì•± ì œì¡°</span>
        </div>
        <div class="route-chip" data-route="RT-Î³">
          <span class="route-greek">Î³</span>
          <span class="route-label">ë³´ì•ˆ ë¼ì¸</span>
        </div>
        <div class="route-chip" data-route="RT-Î´">
          <span class="route-greek">Î´</span>
          <span class="route-label">ê²€ì¦ ë¼ì¸</span>
        </div>
        <div class="route-chip" data-route="RT-Îµ">
          <span class="route-greek">Îµ</span>
          <span class="route-label">ë°ì´í„° ê°€ê³µ</span>
        </div>
        <div class="route-chip" data-route="RT-Î¶">
          <span class="route-greek">Î¶</span>
          <span class="route-label">ì˜¤ë””ì˜¤ ì—”ì§„</span>
        </div>
        <div class="route-chip" data-route="RT-Î·">
          <span class="route-greek">Î·</span>
          <span class="route-label">ë¬¼ì„± ìŠ¤íŠœë””ì˜¤</span>
        </div>
        <div class="route-chip" data-route="RT-Î¸">
          <span class="route-greek">Î¸</span>
          <span class="route-label">ì¸í”„ë¼/ì„¤ì •</span>
        </div>
      </div>
      <label>ì»¤ìŠ¤í…€ ë¼ìš°íŠ¸ ID (ìƒˆë¡œ ë§Œë“¤ ê²½ìš°)</label>
      <input type="text" id="customRoute" placeholder="ì˜ˆ: RT-Î¹ (ìƒˆ ë¼ìš°íŠ¸)">
    </div>

    <!-- Target Repo -->
    <div class="section">
      <p class="section-title">ëŒ€ìƒ ë ˆí¬</p>
      <div class="grid-2">
        <div>
          <label>ë ˆí¬ ì´ë¦„</label>
          <input type="text" id="repoName" placeholder="dtslib1979/my-repo">
        </div>
        <div>
          <label>ì£¼ ëª©ì </label>
          <select id="repoPurpose">
            <option value="production">ìƒì‚° (ì½˜í…ì¸ /ì•±)</option>
            <option value="engine">ì—”ì§„ (ì²˜ë¦¬/ë³€í™˜)</option>
            <option value="storage">ì €ì¥ (ë°ì´í„°/ì—ì…‹)</option>
            <option value="delivery">ì†¡ì¶œ (ë°°í¬/ë°©ì†¡)</option>
            <option value="infra">ì¸í”„ë¼ (ì„¤ì •/ê´€ë¦¬)</option>
          </select>
        </div>
      </div>
      <label>ë¼ìš°íŠ¸ ì„¤ëª… (í•œ ì¤„)</label>
      <input type="text" id="routeDesc" placeholder="ì´ ë¼ìš°íŠ¸ê°€ í•˜ëŠ” ì¼">
    </div>

    <!-- Operations -->
    <div class="section">
      <p class="section-title">ê³µì • ë‹¨ê³„ (OP)</p>
      <div class="op-list" id="opList">
        <div class="op-item" data-index="0">
          <span class="op-num">OP-1</span>
          <input type="text" class="op-input" placeholder="ê³µì • ë‹¨ê³„ ì„¤ëª…" data-field="desc">
          <button class="op-remove" onclick="removeOp(0)">x</button>
        </div>
        <div class="op-item" data-index="1">
          <span class="op-num">OP-2</span>
          <input type="text" class="op-input" placeholder="ê³µì • ë‹¨ê³„ ì„¤ëª…" data-field="desc">
          <button class="op-remove" onclick="removeOp(1)">x</button>
        </div>
        <div class="op-item" data-index="2">
          <span class="op-num">OP-3</span>
          <input type="text" class="op-input" placeholder="ê³µì • ë‹¨ê³„ ì„¤ëª…" data-field="desc">
          <button class="op-remove" onclick="removeOp(2)">x</button>
        </div>
      </div>
      <button class="add-op-btn" onclick="addOp()">+ OP ì¶”ê°€</button>
    </div>

    <!-- Options -->
    <div class="section">
      <p class="section-title">ë¼ìš°íŠ¸ ì˜µì…˜</p>
      <div class="toggles">
        <div class="toggle-row">
          <div>
            <span class="toggle-label">ER (Error Recovery)</span>
            <div class="toggle-desc">ì‹¤íŒ¨ ì‹œ ìë™ ë³µêµ¬ ìŠ¤í¬ë¦½íŠ¸ í¬í•¨</div>
          </div>
          <div class="toggle-switch active" data-key="er"></div>
        </div>
        <div class="toggle-row">
          <div>
            <span class="toggle-label">registry.json ë“±ë¡</span>
            <div class="toggle-desc">ë³¸ì‚¬ ëŒ€ì‹œë³´ë“œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ìë™ ë“±ë¡</div>
          </div>
          <div class="toggle-switch active" data-key="registry"></div>
        </div>
        <div class="toggle-row">
          <div>
            <span class="toggle-label">PHL í† í° ì—°ê²°</span>
            <div class="toggle-desc">PHL í† í°ìœ¼ë¡œ ì´ ë¼ìš°íŠ¸ë¥¼ í˜¸ì¶œ ê°€ëŠ¥</div>
          </div>
          <div class="toggle-switch" data-key="phl"></div>
        </div>
        <div class="toggle-row">
          <div>
            <span class="toggle-label">í¬ë¡œìŠ¤ë ˆí¬ ì¶œë ¥</span>
            <div class="toggle-desc">ë‹¤ë¥¸ ë ˆí¬ë¡œ ê²°ê³¼ë¬¼ ì „ë‹¬</div>
          </div>
          <div class="toggle-switch" data-key="crossRepo"></div>
        </div>
      </div>
    </div>

    <!-- Cross-repo target -->
    <div class="section" id="crossRepoSection" style="display: none;">
      <p class="section-title">í¬ë¡œìŠ¤ë ˆí¬ ëŒ€ìƒ</p>
      <label>ì¶œë ¥ ëŒ€ìƒ ë ˆí¬</label>
      <input type="text" id="outputRepo" placeholder="dtslib1979/target-repo">
      <label>ì¶œë ¥ ê²½ë¡œ</label>
      <input type="text" id="outputPath" placeholder="boards/ ë˜ëŠ” data/">
    </div>

    <!-- PHL Token -->
    <div class="section" id="phlSection" style="display: none;">
      <p class="section-title">PHL í† í° ì—°ê²°</p>
      <div class="grid-2">
        <div>
          <label>í† í° ì´ë¦„</label>
          <input type="text" id="phlToken" placeholder="PHL-NewToken">
        </div>
        <div>
          <label>í† í° Intent</label>
          <input type="text" id="phlIntent" placeholder="ì´ í† í°ì´ í•˜ëŠ” ì¼">
        </div>
      </div>
    </div>

    <!-- Additional Context -->
    <div class="section">
      <p class="section-title">ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸</p>
      <label>íŠ¹ë³„ ìš”êµ¬ì‚¬í•­</label>
      <textarea id="requirements" placeholder="ì˜ˆ: ì´ ë¼ìš°íŠ¸ëŠ” RT-Î± ì™„ë£Œ í›„ì—ë§Œ ì‹¤í–‰. ì˜ì¡´ì„± ìˆìŒ."></textarea>
    </div>

    <!-- Generate -->
    <button class="btn btn-primary" onclick="generatePrompt()">ë¼ìš°íŠ¸ ì •ì˜ í”„ë¡¬í”„íŠ¸ ìƒì„±</button>

    <!-- Output -->
    <div class="section output-section" id="outputSection">
      <div class="output-header">
        <span class="output-title">ìƒì„±ëœ í”„ë¡¬í”„íŠ¸</span>
        <button class="btn btn-secondary" onclick="copyPrompt()">ë³µì‚¬</button>
      </div>
      <div class="output-body">
        <div class="output-prompt" id="outputPrompt"></div>
        <div class="philosophy-note">
          <span class="philosophy-icon">ğŸ­</span>
          <p>ì´ í”„ë¡¬í”„íŠ¸ë¡œ ìƒì„±ëœ ë¼ìš°íŠ¸ ì„¤ì •ì€ <strong>dtslib-papyrus</strong> ë³¸ì‚¬ ëŒ€ì‹œë³´ë“œì˜<br>
          <strong>registry.json</strong>ê³¼ <strong>fab-run.sh</strong>ì— ë°˜ì˜ë©ë‹ˆë‹¤.</p>
        </div>
        <div class="btn-row">
          <button class="btn btn-primary btn-full" onclick="openClaude()">Claudeì—ì„œ ì—´ê¸° â†’</button>
        </div>
      </div>
    </div>

    <footer>
      <a href="../../index.html" class="footer-link">â† OrbitPrompt</a>
    </footer>
  </div>

  <script>
    const ROUTES = {
      'RT-Î±': { name: 'ì½˜í…ì¸  ìƒì‚°', desc: 'ì¹ íŒ/ë°©ì†¡ í…œí”Œë¦¿ ìƒì„±' },
      'RT-Î²': { name: 'ì•± ì œì¡°', desc: 'PWA ìƒì„± â†’ APK ì¶œí•˜' },
      'RT-Î³': { name: 'ë³´ì•ˆ ë¼ì¸', desc: 'ë³´ì•ˆ ê°•í™” / OWASP ê²€ì¦' },
      'RT-Î´': { name: 'ê²€ì¦ ë¼ì¸', desc: 'ì—­ë°©í–¥ ê²€ì¦ / ì¼ê´€ì„± ì²´í¬' },
      'RT-Îµ': { name: 'ë°ì´í„° ê°€ê³µ', desc: 'ëŒ€í™” ë¡œê·¸ â†’ íŒŒì¸íŠœë‹ ë°ì´í„°ì…‹' },
      'RT-Î¶': { name: 'ì˜¤ë””ì˜¤ ì—”ì§„', desc: 'BGM íŒŒì´í”„ë¼ì¸ / 3-Layer ë¯¹ì‹±' },
      'RT-Î·': { name: 'ë¬¼ì„± ìŠ¤íŠœë””ì˜¤', desc: 'ë…¹ìŒ/ë…¹í™”/ë Œë” ê³µì •' },
      'RT-Î¸': { name: 'ì¸í”„ë¼/ì„¤ì •', desc: 'CLAUDE.md / í”„ë¡œí† ì½œ ë°°í¬' }
    };

    let state = {
      route: 'RT-Î±',
      customRoute: '',
      repoName: '',
      repoPurpose: 'production',
      routeDesc: '',
      ops: ['', '', ''],
      er: true,
      registry: true,
      phl: false,
      crossRepo: false,
      outputRepo: '',
      outputPath: '',
      phlToken: '',
      phlIntent: '',
      requirements: ''
    };

    let opCount = 3;

    // Route selection
    document.querySelectorAll('.route-chip').forEach(chip => {
      chip.addEventListener('click', () => {
        document.querySelectorAll('.route-chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        state.route = chip.dataset.route;
      });
    });

    // Toggle switches
    document.querySelectorAll('.toggle-switch').forEach(toggle => {
      toggle.addEventListener('click', () => {
        toggle.classList.toggle('active');
        const key = toggle.dataset.key;
        state[key] = toggle.classList.contains('active');

        if (key === 'crossRepo') {
          document.getElementById('crossRepoSection').style.display = state.crossRepo ? 'block' : 'none';
        }
        if (key === 'phl') {
          document.getElementById('phlSection').style.display = state.phl ? 'block' : 'none';
        }
      });
    });

    // Input bindings
    document.getElementById('customRoute').addEventListener('input', e => state.customRoute = e.target.value);
    document.getElementById('repoName').addEventListener('input', e => state.repoName = e.target.value);
    document.getElementById('repoPurpose').addEventListener('change', e => state.repoPurpose = e.target.value);
    document.getElementById('routeDesc').addEventListener('input', e => state.routeDesc = e.target.value);
    document.getElementById('outputRepo').addEventListener('input', e => state.outputRepo = e.target.value);
    document.getElementById('outputPath').addEventListener('input', e => state.outputPath = e.target.value);
    document.getElementById('phlToken').addEventListener('input', e => state.phlToken = e.target.value);
    document.getElementById('phlIntent').addEventListener('input', e => state.phlIntent = e.target.value);
    document.getElementById('requirements').addEventListener('input', e => state.requirements = e.target.value);

    // OP management
    function addOp() {
      const list = document.getElementById('opList');
      const index = opCount++;
      const item = document.createElement('div');
      item.className = 'op-item';
      item.dataset.index = index;
      item.innerHTML = `
        <span class="op-num">OP-${index + 1}</span>
        <input type="text" class="op-input" placeholder="ê³µì • ë‹¨ê³„ ì„¤ëª…" data-field="desc">
        <button class="op-remove" onclick="removeOp(${index})">x</button>
      `;
      list.appendChild(item);
    }

    function removeOp(index) {
      const item = document.querySelector(`.op-item[data-index="${index}"]`);
      if (item && document.querySelectorAll('.op-item').length > 1) {
        item.remove();
        updateOpNumbers();
      }
    }

    function updateOpNumbers() {
      document.querySelectorAll('.op-item').forEach((item, i) => {
        item.querySelector('.op-num').textContent = `OP-${i + 1}`;
      });
    }

    function getOps() {
      return Array.from(document.querySelectorAll('.op-item .op-input'))
        .map(input => input.value)
        .filter(v => v.trim());
    }

    const purposeLabels = {
      production: 'ìƒì‚° (ì½˜í…ì¸ /ì•± ì¶œë ¥)',
      engine: 'ì—”ì§„ (ì²˜ë¦¬/ë³€í™˜)',
      storage: 'ì €ì¥ (ë°ì´í„°/ì—ì…‹)',
      delivery: 'ì†¡ì¶œ (ë°°í¬/ë°©ì†¡)',
      infra: 'ì¸í”„ë¼ (ì„¤ì •/ê´€ë¦¬)'
    };

    function generatePrompt() {
      const routeId = state.customRoute || state.route;
      const routeInfo = ROUTES[state.route] || { name: 'ì»¤ìŠ¤í…€', desc: '' };
      const ops = getOps();

      const features = [];
      if (state.er) features.push('ER (Error Recovery) ìë™ ë³µêµ¬');
      if (state.registry) features.push('registry.json ìë™ ë“±ë¡');
      if (state.phl) features.push(`PHL í† í° ì—°ê²° (${state.phlToken || 'TBD'})`);
      if (state.crossRepo) features.push(`í¬ë¡œìŠ¤ë ˆí¬ ì¶œë ¥ â†’ ${state.outputRepo || 'TBD'}`);

      const prompt = `# FAB ë¼ìš°íŠ¸ ì •ì˜ ìš”ì²­

## ë¼ìš°íŠ¸ ì •ë³´
- **ë¼ìš°íŠ¸ ID**: ${routeId}
- **ë¼ìš°íŠ¸ëª…**: ${routeInfo.name}
- **ì„¤ëª…**: ${state.routeDesc || routeInfo.desc}
- **ëŒ€ìƒ ë ˆí¬**: ${state.repoName || '(ë¯¸ì •)'}
- **ë ˆí¬ ëª©ì **: ${purposeLabels[state.repoPurpose]}

## ê³µì • ë‹¨ê³„ (Operations)
${ops.length > 0 ? ops.map((op, i) => `### OP-${i + 1}: ${op}
- **ì…ë ¥**: [ì´ì „ ë‹¨ê³„ ì¶œë ¥ ë˜ëŠ” ì›ìì¬]
- **ì²˜ë¦¬**: [ì´ ë‹¨ê³„ì—ì„œ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…]
- **ì¶œë ¥**: [ë‹¤ìŒ ë‹¨ê³„ë¡œ ì „ë‹¬ë˜ëŠ” ê²°ê³¼ë¬¼]
- **ê²€ì¦**: [í†µê³¼ ì¡°ê±´]
- **ER**: ${state.er ? '[ì‹¤íŒ¨ ì‹œ ë³µêµ¬ ëª…ë ¹]' : 'ì—†ìŒ'}
`).join('\n') : '(ê³µì • ë‹¨ê³„ë¥¼ ì •ì˜í•´ì£¼ì„¸ìš”)'}

## ë¼ìš°íŠ¸ ì˜µì…˜
${features.map(f => '- ' + f).join('\n')}

${state.phl ? `## PHL í† í° ì—°ê²°
- **í† í°ëª…**: ${state.phlToken || '(ë¯¸ì •)'}
- **Intent**: ${state.phlIntent || '(ë¯¸ì •)'}
- **í˜¸ì¶œ ì‹œ**: ì´ ë¼ìš°íŠ¸ì˜ ì „ì²´ ê³µì •ì„ ìˆœì°¨ ì‹¤í–‰
` : ''}
${state.crossRepo ? `## í¬ë¡œìŠ¤ë ˆí¬ ì¶œë ¥
- **ëŒ€ìƒ ë ˆí¬**: ${state.outputRepo || '(ë¯¸ì •)'}
- **ì¶œë ¥ ê²½ë¡œ**: ${state.outputPath || '(ë¯¸ì •)'}
- **ì „ë‹¬ ë°©ì‹**: ëª…ì‹œì  ìŠ¤í¬ë¦½íŠ¸ (ì¸í„°í˜ì´ìŠ¤ ìš°íšŒ ê¸ˆì§€)
` : ''}
${state.requirements ? `## íŠ¹ë³„ ìš”êµ¬ì‚¬í•­
${state.requirements}
` : ''}
## ì¶œë ¥ ìš”êµ¬ì‚¬í•­

### 1. registry.json ì—”íŠ¸ë¦¬
\`\`\`json
{
  "${routeId}": {
    "name": "${routeInfo.name}",
    "repo": "${state.repoName || 'TBD'}",
    "ops": [${ops.map(op => `"${op}"`).join(', ')}],
    "er_enabled": ${state.er},
    "status": "active"
  }
}
\`\`\`

### 2. fab-run.sh ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬
- \`fab-run.sh --route=${routeId}\` ë¡œ ì „ì²´ ê³µì • ì‹¤í–‰
- \`fab-run.sh --route=${routeId} --op=N\` ë¡œ íŠ¹ì • OPë§Œ ì‹¤í–‰
${state.er ? `- \`fab-run.sh --route=${routeId} --er\` ë¡œ ER ì‹¤í–‰` : ''}

### 3. ë¼ìš°íŠ¸ ì •ì˜ ë¬¸ì„œ
- \`routes/${routeId}.md\` ë§ˆí¬ë‹¤ìš´ ì •ì˜ì„œ
- ê³µì • íë¦„ë„ (ASCII)
- OPë³„ ì…ì¶œë ¥ ëª…ì„¸

## ë§¤íŠ¸ë¦­ìŠ¤ ì•„í‚¤í…ì²˜ ì¤€ìˆ˜
- **ê°€ë¡œì¶• (ERP)**: registry.json = ì›ì¥. ì´ ë¼ìš°íŠ¸ì˜ ëª¨ë“  ê±°ë˜ëŠ” ê¸°ë¡.
- **ì„¸ë¡œì¶• (FAB)**: ê³µì • ìˆœì„œ ì—„ìˆ˜. OP ìˆœì„œ ë³€ê²½ ì‹œ BOM í™•ì¸ í•„ìˆ˜.
- **ì»¤ë°‹ = ì „í‘œ**: ê° OP ì™„ë£Œ ì‹œ ì»¤ë°‹. squash ê¸ˆì§€.`;

      document.getElementById('outputPrompt').textContent = prompt;
      document.getElementById('outputSection').style.display = 'block';
      document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
    }

    function copyPrompt() {
      navigator.clipboard.writeText(document.getElementById('outputPrompt').textContent);
    }

    function openClaude() {
      const text = encodeURIComponent(document.getElementById('outputPrompt').textContent);
      window.open(`https://claude.ai/new?q=${text}`, '_blank');
    }
  </script>
</body>
</html>
